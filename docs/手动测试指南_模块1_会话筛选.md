# 模块1：会话高级筛选与搜索 - 手动测试指南

> **测试环境**: 坐席工作台
> **测试对象**: L1-1-Part1-模块1 会话高级筛选与搜索功能
> **创建时间**: 2025-01-27
> **必须按照**: CLAUDE.md 的完整服务访问地址

---

## 📋 测试前准备

### 1. 启动所有服务

```bash
# 1. 后端服务
cd /home/yzh/AI客服/鉴权
python3 backend.py
# 访问: http://localhost:8000
# API文档: http://localhost:8000/docs

# 2. 坐席工作台
cd /home/yzh/AI客服/鉴权/agent-workbench
npm run dev
# 本地访问: http://localhost:5174
# 局域网访问: http://192.168.x.x:5174
```

### 2. 登录坐席工作台

**默认测试账号**:
- 管理员: `admin / admin123`
- 坐席: `agent001 / agent123`

**访问地址** (根据CLAUDE.md):
- **本地访问**: http://localhost:5174
- **局域网访问**: http://192.168.x.x:5174 (替换为实际IP)

### 3. 确认测试数据

确保系统中有以下测试数据:
- ✅ 至少有3个不同状态的会话(pending_manual, manual_live, bot_active)
- ✅ 至少有1个VIP客户会话
- ✅ 至少有5个会话方便测试筛选

---

## 🧪 功能测试清单

### 测试1: 状态筛选功能

**步骤**:
1. 打开坐席工作台: http://localhost:5174 或 http://192.168.x.x:5174
2. 登录系统
3. 观察顶部统计栏的数字
4. 点击"待接入"标签
5. 点击"服务中"标签
6. 点击"全部"标签

**预期结果**:
- ✅ 点击"待接入"时，只显示pending_manual状态的会话
- ✅ 点击"服务中"时，只显示manual_live状态的会话
- ✅ 点击"全部"时，显示所有会话
- ✅ 列表实时刷新，数量正确

**实际结果**: [ 填写测试结果 ]

---

### 测试2: 时间范围筛选

**步骤**:
1. 在筛选标签下方，找到第一个下拉框(时间范围筛选)
2. 选择"今天"
3. 选择"最近3天"
4. 选择"最近7天"
5. 选择"本月"

**预期结果**:
- ✅ 选择"今天"时，只显示今天创建的会话
- ✅ 选择"最近3天"时，显示最近72小时的会话
- ✅ 列表数量随筛选条件变化
- ✅ 筛选响应时间 < 500ms

**实际结果**: [ 填写测试结果 ]

---

### 测试3: 客户类型筛选

**步骤**:
1. 找到第二个下拉框(客户类型筛选)
2. 选择"全部客户"
3. 选择"VIP客户"
4. 选择"老客户"
5. 选择"新客户"

**预期结果**:
- ✅ 选择"VIP客户"时，只显示vip=true的会话
- ✅ 选择"老客户"时，显示有订单历史的客户
- ✅ 选择"新客户"时，显示无订单历史的客户
- ✅ VIP客户会话有明显的VIP标识

**实际结果**: [ 填写测试结果 ]

---

### 测试4: 排序功能

**步骤**:
1. 找到第三个下拉框(排序方式)
2. 依次选择:
   - 默认排序
   - 最新优先
   - 最早优先
   - VIP优先
   - 等待时长

**预期结果**:
- ✅ "默认排序": VIP客户 > pending_manual > manual_live > 时间倒序
- ✅ "最新优先": 按更新时间降序排列
- ✅ "最早优先": 按更新时间升序排列
- ✅ "VIP优先": VIP客户排在最前面
- ✅ "等待时长": 等待时间长的会话排在前面
- ✅ 排序切换流畅，< 100ms

**实际结果**: [ 填写测试结果 ]

---

### 测试5: 关键词搜索功能

**步骤**:
1. 在搜索框中输入"张三"
2. 等待500ms (防抖)
3. 输入"vip"
4. 输入会话ID (如: session_xxx)
5. 输入消息关键词 (如: "电池")
6. 清空搜索框

**预期结果**:
- ✅ 输入后500ms自动搜索
- ✅ 搜索结果包含昵称中有"张三"的会话
- ✅ 搜索结果包含对话内容中的关键词
- ✅ 搜索结果数量正确显示
- ✅ 清空搜索框后恢复所有会话
- ✅ 搜索响应时间 < 500ms

**实际结果**: [ 填写测试结果 ]

---

### 测试6: 组合筛选

**步骤**:
1. 设置筛选条件:
   - 状态: 待接入
   - 时间: 今天
   - 客户类型: VIP客户
   - 排序: VIP优先
2. 观察结果

**预期结果**:
- ✅ 只显示今天创建的、VIP客户、待接入状态的会话
- ✅ 符合所有筛选条件(AND逻辑)
- ✅ 列表数量正确

**实际结果**: [ 填写测试结果 ]

---

### 测试7: 搜索 + 筛选组合

**步骤**:
1. 选择状态: 全部
2. 选择客户类型: VIP客户
3. 在搜索框输入: "电池"
4. 观察结果

**预期结果**:
- ✅ 显示符合条件的会话: VIP客户 AND 对话中包含"电池"
- ✅ 结果正确

**实际结果**: [ 填写测试结果 ]

---

### 测试8: 性能测试

**步骤**:
1. 切换不同筛选条件10次
2. 输入搜索关键词并清空5次
3. 切换排序方式5次

**预期结果**:
- ✅ 筛选响应时间 < 200ms
- ✅ 搜索响应时间 < 500ms (含防抖)
- ✅ 排序响应时间 < 100ms
- ✅ 界面不卡顿，流畅

**实际结果**: [ 填写测试结果 ]

---

### 测试9: 边界情况测试

**步骤**:
1. 筛选无结果的条件 (如: VIP+某个不存在的时间范围)
2. 搜索不存在的关键词
3. 快速切换筛选条件 (压力测试)

**预期结果**:
- ✅ 无结果时显示空列表，不报错
- ✅ 显示"共 0 个会话"
- ✅ 快速切换不会导致错误或卡死

**实际结果**: [ 填写测试结果 ]

---

## ✅ 验收标准总结

### 功能验收
- [ ] 可按3种状态筛选会话
- [ ] 可按4种时间范围筛选
- [ ] 可按4种客户类型筛选
- [ ] 支持5种排序方式
- [ ] 搜索功能支持昵称、会话ID、对话内容
- [ ] 组合筛选逻辑正确(AND逻辑)
- [ ] 筛选结果数量正确显示

### 性能验收
- [ ] 筛选响应时间 < 200ms
- [ ] 搜索响应时间 < 500ms
- [ ] 排序响应时间 < 100ms
- [ ] 支持10个坐席并发筛选

### UI验收
- [ ] VIP客户有明显标识
- [ ] 搜索框有清除按钮
- [ ] 筛选控件布局合理
- [ ] 响应式布局正常

---

## 🐛 问题记录

### 发现的问题
| 问题ID | 描述 | 严重程度 | 状态 |
|--------|------|---------|------|
| | | | |

---

## 📊 测试结果

- **测试时间**: ___________
- **测试人员**: ___________
- **测试环境**: ___________
- **总体评估**: ___________

---

## 📝 备注

[在此记录测试过程中的特殊情况或建议]
