# å·¥å•ç³»ç»Ÿå®æ–½æ–¹æ¡ˆè¯¦è§£

> **ç‰ˆæœ¬**: v1.0
> **åˆ›å»ºæ—¶é—´**: 2025-11-25
> **è´Ÿè´£äºº**: Claude Code
> **çŠ¶æ€**: ğŸ“ æ–¹æ¡ˆå¾…å®¡æ ¸

---

## ğŸ“‹ ä¸ºä»€ä¹ˆéœ€è¦å·¥å•ç³»ç»Ÿï¼Ÿ

### å½“å‰é—®é¢˜åˆ†æ

**ç°çŠ¶**: å½“å‰ AI å®¢æœç³»ç»Ÿå®ç°äº†äººå·¥æ¥ç®¡åŠŸèƒ½ï¼Œåå¸­å¯ä»¥å®æ—¶åœ¨çº¿å›å¤ç”¨æˆ·ã€‚ä½†å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š

#### é—®é¢˜1: å¤æ‚é—®é¢˜æ— æ³•é—­ç¯

**åœºæ™¯**:
```
ç”¨æˆ·: "æˆ‘çš„ C11 Pro ç”µæ± å……ä¸è¿›ç”µäº†ï¼Œæ˜¨å¤©åˆšä¹°çš„"
åå¸­: "æ‚¨å¥½ï¼Œè¿™éœ€è¦æŠ€æœ¯å›¢é˜Ÿè¯Šæ–­ï¼Œæˆ‘å¸®æ‚¨è®°å½•ä¸€ä¸‹"
ç”¨æˆ·: "å¥½çš„ï¼Œä»€ä¹ˆæ—¶å€™èƒ½è§£å†³ï¼Ÿ"
åå¸­: "æˆ‘ä¼šè½¬ç»™æŠ€æœ¯éƒ¨ï¼Œä½†æˆ‘æ— æ³•è·Ÿè¸ªè¿›åº¦..."
```

**é—®é¢˜**: åå¸­æ— æ³•åˆ›å»ºå·¥å•ã€æ— æ³•è·Ÿè¸ªå¤„ç†è¿›åº¦ã€æ— æ³•é€šçŸ¥ç”¨æˆ·ç»“æœã€‚

#### é—®é¢˜2: è·¨å›¢é˜Ÿåä½œå›°éš¾

**åœºæ™¯**:
```
å”®å‰åå¸­ â†’ éœ€è¦é…ä»¶åº“å­˜ä¿¡æ¯ â†’ æ— æ³•ç›´æ¥è”ç³»ä»“å‚¨éƒ¨é—¨
æŠ€æœ¯åå¸­ â†’ éœ€è¦è®¢å•ä¿¡æ¯ â†’ æ— æ³•ç›´æ¥æŸ¥è¯¢ Shopify æ•°æ®
å”®ååå¸­ â†’ éœ€è¦ RMA å®¡æ‰¹ â†’ æ— æ³•è‡ªåŠ¨æµè½¬åˆ°å®¡æ‰¹äºº
```

**é—®é¢˜**: å„éƒ¨é—¨ä¿¡æ¯å­¤å²›ï¼Œåä½œä¾èµ–é‚®ä»¶/å¾®ä¿¡ï¼Œæ•ˆç‡ä½ä¸‹ã€‚

#### é—®é¢˜3: æœåŠ¡è´¨é‡æ— æ³•é‡åŒ–

**åœºæ™¯**:
```
- æœ‰å¤šå°‘é—®é¢˜åœ¨ 24 å°æ—¶å†…è§£å†³ï¼Ÿ
- ç”µæ± é—®é¢˜å¹³å‡å¤„ç†æ—¶é•¿æ˜¯å¤šå°‘ï¼Ÿ
- å“ªä¸ªåå¸­çš„è§£å†³ç‡æœ€é«˜ï¼Ÿ
```

**é—®é¢˜**: æ— æ³•ç»Ÿè®¡ SLA è¾¾æˆç‡ã€æ— æ³•è¯„ä¼°åå¸­ç»©æ•ˆã€æ— æ³•ä¼˜åŒ–æœåŠ¡æµç¨‹ã€‚

### ä¸šåŠ¡ä»·å€¼

å®æ–½å·¥å•ç³»ç»Ÿåï¼Œå¯ä»¥å®ç°ï¼š

1. **å®Œæ•´é—­ç¯**: ä»ç”¨æˆ·å’¨è¯¢ â†’ å·¥å•åˆ›å»º â†’ è·¨éƒ¨é—¨å¤„ç† â†’ é—®é¢˜è§£å†³ â†’ ç”¨æˆ·é€šçŸ¥
2. **åä½œé«˜æ•ˆ**: å”®å‰/å”®å/æŠ€æœ¯/ä»“å‚¨/åˆè§„éƒ¨é—¨åœ¨åŒä¸€å¹³å°åä½œ
3. **æ•°æ®é©±åŠ¨**: SLA ç»Ÿè®¡ã€é—®é¢˜åˆ†ç±»ã€åå¸­ç»©æ•ˆã€ç”¨æˆ·æ»¡æ„åº¦
4. **çŸ¥è¯†æ²‰æ·€**: å…¸å‹é—®é¢˜æ²‰æ·€ä¸ºçŸ¥è¯†åº“ï¼Œæå‡ AI å›ç­”è´¨é‡

---

## ğŸ”§ æŠ€æœ¯åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ

### æ ¸å¿ƒæ¦‚å¿µ

#### 1. å·¥å•ï¼ˆTicketï¼‰

**å®šä¹‰**: ä¸€ä¸ªéœ€è¦è·¨éƒ¨é—¨åä½œè§£å†³çš„ç”¨æˆ·é—®é¢˜çš„è®°å½•å•å…ƒ

**ç”Ÿå‘½å‘¨æœŸ**:
```
å¾…æ¥å• â†’ å¤„ç†ä¸­ â†’ å¾…å®¢æˆ· â†’ å·²è§£å†³ â†’ å·²å…³é—­
   â†“         â†“         â†“         â†“
  è‡ªåŠ¨    åå¸­å¤„ç†   ç”¨æˆ·ç¡®è®¤   å½’æ¡£
  åˆ†é…    (å¯è½¬æ´¾)   (å¯é‡å¼€)   (å¯å¯¼å‡º)
```

**æ ¸å¿ƒå­—æ®µ**:
- `ticket_id`: å·¥å•ç¼–å·ï¼ˆå¦‚ TKT-2025-001234ï¼‰
- `session_name`: å…³è”çš„ä¼šè¯ ID
- `order_id`: å…³è”çš„è®¢å•å·ï¼ˆShopify Order IDï¼‰
- `category`: é—®é¢˜åˆ†ç±»ï¼ˆå”®å‰/è®¢å•/ç‰©æµ/å”®å/åˆè§„ï¼‰
- `priority`: ä¼˜å…ˆçº§ï¼ˆlow/medium/high/urgentï¼‰
- `status`: å½“å‰çŠ¶æ€
- `assigned_to`: å½“å‰è´Ÿè´£äºº
- `sla_deadline`: SLA æˆªæ­¢æ—¶é—´
- `created_at`: åˆ›å»ºæ—¶é—´
- `resolved_at`: è§£å†³æ—¶é—´

#### 2. å·¥å•æµè½¬ï¼ˆWorkflowï¼‰

**æµè½¬è§„åˆ™**:
```python
class TicketWorkflow:
    # çŠ¶æ€è½¬æ¢çŸ©é˜µ
    TRANSITIONS = {
        "å¾…æ¥å•": ["å¤„ç†ä¸­", "å·²å…³é—­"],  # å¯æ¥å•æˆ–å…³é—­ï¼ˆé‡å¤/æ— æ•ˆï¼‰
        "å¤„ç†ä¸­": ["å¾…å®¢æˆ·", "å·²è§£å†³", "å¾…æ¥å•"],  # å¯è½¬ç»™å…¶ä»–éƒ¨é—¨
        "å¾…å®¢æˆ·": ["å¤„ç†ä¸­", "å·²è§£å†³"],  # ç”¨æˆ·åé¦ˆåç»§ç»­æˆ–è§£å†³
        "å·²è§£å†³": ["å·²å…³é—­", "å¤„ç†ä¸­"],  # å¯å…³é—­æˆ–é‡å¼€
        "å·²å…³é—­": []  # ç»ˆæ€
    }
```

**è‡ªåŠ¨æµè½¬è§¦å‘å™¨**:
- åˆ›å»ºå·¥å•æ—¶ â†’ è‡ªåŠ¨åˆ†é…ç»™å¯¹åº”éƒ¨é—¨
- è¶…è¿‡ SLA æ—¶é—´ â†’ è‡ªåŠ¨å‡çº§ä¼˜å…ˆçº§ + é€šçŸ¥ç»„é•¿
- ç”¨æˆ·å›å¤å â†’ è‡ªåŠ¨ä»"å¾…å®¢æˆ·"è½¬ä¸º"å¤„ç†ä¸­"
- 7å¤©æ— æ“ä½œ â†’ è‡ªåŠ¨å…³é—­

#### 3. SLAï¼ˆService Level Agreementï¼‰

**å®šä¹‰**: æœåŠ¡ç­‰çº§åè®®ï¼Œè§„å®šé—®é¢˜å¿…é¡»åœ¨å¤šé•¿æ—¶é—´å†…å“åº”/è§£å†³

**SLA è§„åˆ™**:
```python
SLA_RULES = {
    "urgent": {
        "first_response": 15 * 60,  # 15åˆ†é’Ÿå†…é¦–æ¬¡å“åº”
        "resolution": 4 * 3600,     # 4å°æ—¶å†…è§£å†³
    },
    "high": {
        "first_response": 1 * 3600,  # 1å°æ—¶å†…é¦–æ¬¡å“åº”
        "resolution": 24 * 3600,     # 24å°æ—¶å†…è§£å†³
    },
    "medium": {
        "first_response": 4 * 3600,  # 4å°æ—¶å†…é¦–æ¬¡å“åº”
        "resolution": 72 * 3600,     # 3å¤©å†…è§£å†³
    },
    "low": {
        "first_response": 24 * 3600,  # 24å°æ—¶å†…é¦–æ¬¡å“åº”
        "resolution": 7 * 24 * 3600,  # 7å¤©å†…è§£å†³
    }
}
```

**SLA è®¡ç®—**:
```python
def calculate_sla_status(ticket):
    """è®¡ç®— SLA çŠ¶æ€"""
    now = time.time()
    created_at = ticket.created_at

    # é¦–æ¬¡å“åº” SLA
    first_response_deadline = created_at + SLA_RULES[ticket.priority]["first_response"]
    if not ticket.first_response_at:
        if now > first_response_deadline:
            return "breached"  # å·²è¿å SLA
        elif now > first_response_deadline - 15 * 60:
            return "at_risk"   # å³å°†è¿å SLA
        else:
            return "on_track"  # æ­£å¸¸

    # è§£å†³ SLA
    resolution_deadline = created_at + SLA_RULES[ticket.priority]["resolution"]
    if not ticket.resolved_at:
        if now > resolution_deadline:
            return "breached"
        elif now > resolution_deadline - 1 * 3600:
            return "at_risk"
        else:
            return "on_track"

    return "completed"
```

---

## ğŸ› ï¸ éœ€è¦ä»€ä¹ˆå·¥å…·å’Œé…ç½®ï¼Ÿ

### åç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç”¨é€” | åŸå›  |
|------|------|------|
| **FastAPI** | Web æ¡†æ¶ | å·²ä½¿ç”¨ï¼Œä¿æŒä¸€è‡´ |
| **PostgreSQL** | æ•°æ®åº“ | å·¥å•æ•°æ®æŒä¹…åŒ–å­˜å‚¨ï¼ˆSQLite ä¸é€‚åˆç”Ÿäº§ç¯å¢ƒï¼‰|
| **Redis** | ç¼“å­˜ | SLA å€’è®¡æ—¶ã€å®æ—¶é€šçŸ¥é˜Ÿåˆ— |
| **Celery** | å¼‚æ­¥ä»»åŠ¡ | SLA æ£€æŸ¥ã€é‚®ä»¶é€šçŸ¥ã€Slack é€šçŸ¥ |

### å‰ç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç”¨é€” |
|------|------|
| **Vue 3** | å‰ç«¯æ¡†æ¶ï¼ˆå·²ä½¿ç”¨ï¼‰|
| **Element Plus** | UI ç»„ä»¶åº“ï¼ˆå·¥å•åˆ—è¡¨ã€è¡¨å•ã€æ—¶é—´çº¿ï¼‰|
| **Vuex/Pinia** | çŠ¶æ€ç®¡ç† |

### å¤–éƒ¨é›†æˆ

| ç³»ç»Ÿ | é›†æˆæ–¹å¼ | ç”¨é€” |
|------|---------|------|
| **Shopify API** | REST API | è·å–è®¢å•ä¿¡æ¯ |
| **Slack/ä¼ä¸šå¾®ä¿¡** | Webhook | å·¥å•é€šçŸ¥ |
| **é‚®ä»¶æœåŠ¡** | SMTP | é‚®ä»¶é€šçŸ¥ |

### ç¯å¢ƒé…ç½®

**æ–°å¢ç¯å¢ƒå˜é‡**:
```bash
# æ•°æ®åº“é…ç½®
DATABASE_URL=postgresql://user:pass@localhost:5432/fiido_tickets

# Redis é…ç½®
REDIS_URL=redis://localhost:6379/1

# Celery é…ç½®
CELERY_BROKER_URL=redis://localhost:6379/2
CELERY_RESULT_BACKEND=redis://localhost:6379/3

# Shopify é…ç½®
SHOPIFY_API_KEY=your_api_key
SHOPIFY_API_SECRET=your_api_secret
SHOPIFY_STORE_URL=fiido.myshopify.com

# é€šçŸ¥é…ç½®
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/xxx
WECHAT_WORK_WEBHOOK=https://qyapi.weixin.qq.com/xxx
```

---

## ğŸ“ æ•°æ®æ¨¡å‹è®¾è®¡

### 1. Ticket è¡¨

```python
from sqlalchemy import Column, String, Integer, DateTime, Enum, JSON
from sqlalchemy.ext.declarative import declarative_base

Base = declarative_base()

class Ticket(Base):
    __tablename__ = "tickets"

    # ä¸»é”®
    id = Column(Integer, primary_key=True, autoincrement=True)
    ticket_id = Column(String(50), unique=True, index=True)  # TKT-2025-001234

    # å…³è”ä¿¡æ¯
    session_name = Column(String(100), index=True)  # å…³è”ä¼šè¯
    order_id = Column(String(100), nullable=True)   # Shopify è®¢å•å·
    user_email = Column(String(200), nullable=True)

    # å·¥å•åŸºæœ¬ä¿¡æ¯
    category = Column(Enum("presale", "order", "logistics", "aftersale", "compliance"))
    sub_category = Column(String(50), nullable=True)  # å­åˆ†ç±»ï¼ˆå¦‚"ç”µæ± é—®é¢˜"ï¼‰
    priority = Column(Enum("low", "medium", "high", "urgent"), default="medium")
    status = Column(Enum("pending", "in_progress", "waiting_customer", "resolved", "closed"))

    # å†…å®¹
    title = Column(String(200))
    description = Column(String(5000))

    # è´Ÿè´£äºº
    assigned_to = Column(String(100), nullable=True)  # agent_id
    assigned_team = Column(String(50), nullable=True)  # éƒ¨é—¨ï¼ˆå”®å‰/å”®å/æŠ€æœ¯ï¼‰

    # SLA
    sla_first_response_deadline = Column(DateTime, nullable=True)
    sla_resolution_deadline = Column(DateTime, nullable=True)
    first_response_at = Column(DateTime, nullable=True)
    resolved_at = Column(DateTime, nullable=True)

    # æ—¶é—´æˆ³
    created_at = Column(DateTime, default=datetime.utcnow)
    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)
    closed_at = Column(DateTime, nullable=True)

    # é™„åŠ æ•°æ®
    metadata = Column(JSON, nullable=True)  # é¢å¤–ä¿¡æ¯ï¼ˆå¦‚è½¦å‹ã€VINï¼‰
```

### 2. TicketComment è¡¨ï¼ˆå·¥å•ç•™è¨€ï¼‰

```python
class TicketComment(Base):
    __tablename__ = "ticket_comments"

    id = Column(Integer, primary_key=True, autoincrement=True)
    ticket_id = Column(String(50), index=True)  # å…³è”å·¥å•

    # ç•™è¨€è€…
    author_id = Column(String(100))  # agent_id æˆ– user_id
    author_name = Column(String(100))
    author_role = Column(Enum("agent", "system", "user"))

    # å†…å®¹
    content = Column(String(5000))
    attachments = Column(JSON, nullable=True)  # é™„ä»¶URLåˆ—è¡¨

    # ç±»å‹
    is_internal = Column(Boolean, default=False)  # å†…éƒ¨ç•™è¨€ï¼ˆä¸å¯¹ç”¨æˆ·å¯è§ï¼‰

    # æ—¶é—´æˆ³
    created_at = Column(DateTime, default=datetime.utcnow)
```

### 3. TicketHistory è¡¨ï¼ˆå·¥å•æ“ä½œå†å²ï¼‰

```python
class TicketHistory(Base):
    __tablename__ = "ticket_history"

    id = Column(Integer, primary_key=True, autoincrement=True)
    ticket_id = Column(String(50), index=True)

    # æ“ä½œä¿¡æ¯
    action = Column(String(50))  # created/assigned/status_changed/commented/closed
    operator_id = Column(String(100))
    operator_name = Column(String(100))

    # å˜æ›´å†…å®¹
    changes = Column(JSON)  # {"status": {"from": "pending", "to": "in_progress"}}

    # æ—¶é—´æˆ³
    created_at = Column(DateTime, default=datetime.utcnow)
```

---

## ğŸ”Œ API æ¥å£è®¾è®¡

### 1. åˆ›å»ºå·¥å•

```http
POST /api/tickets
Authorization: Bearer {JWT_TOKEN}
Content-Type: application/json

Body:
{
  "session_name": "session_123",
  "order_id": "1234567890",  # å¯é€‰
  "category": "aftersale",
  "sub_category": "battery_issue",
  "priority": "high",
  "title": "C11 Pro ç”µæ± å……ä¸è¿›ç”µ",
  "description": "ç”¨æˆ·åé¦ˆæ˜¨å¤©åˆšä¹°çš„ C11 Proï¼Œç”µæ± æ— æ³•å……ç”µ",
  "metadata": {
    "model": "C11 Pro",
    "vin": "FC11P2024001234"
  }
}

Response 201:
{
  "success": true,
  "data": {
    "ticket_id": "TKT-2025-001234",
    "status": "pending",
    "assigned_team": "aftersale",
    "sla_deadline": "2025-11-26T10:00:00Z"
  }
}
```

### 2. è·å–å·¥å•åˆ—è¡¨

```http
GET /api/tickets?status=in_progress&assigned_to=agent_001&limit=20

Response 200:
{
  "success": true,
  "data": {
    "tickets": [
      {
        "ticket_id": "TKT-2025-001234",
        "title": "C11 Pro ç”µæ± å……ä¸è¿›ç”µ",
        "status": "in_progress",
        "priority": "high",
        "assigned_to": "agent_001",
        "sla_status": "on_track",
        "created_at": "2025-11-25T10:00:00Z"
      }
    ],
    "total": 15,
    "has_more": false
  }
}
```

### 3. æ›´æ–°å·¥å•çŠ¶æ€

```http
PUT /api/tickets/{ticket_id}/status
Body:
{
  "status": "resolved",
  "resolution_note": "å·²å¯„é€æ–°ç”µæ± ï¼Œè¿½è¸ªå· 1234567890"
}

Response 200:
{
  "success": true,
  "data": {
    "ticket_id": "TKT-2025-001234",
    "status": "resolved",
    "resolved_at": "2025-11-25T14:30:00Z"
  }
}
```

### 4. æ·»åŠ å·¥å•ç•™è¨€

```http
POST /api/tickets/{ticket_id}/comments
Body:
{
  "content": "æŠ€æœ¯å›¢é˜Ÿå·²ç¡®è®¤æ˜¯ç”µæ± å……ç”µå™¨æ•…éšœï¼Œå°†å¯„é€æ–°å……ç”µå™¨",
  "is_internal": false,  # å¯¹ç”¨æˆ·å¯è§
  "attachments": ["https://fiido.com/files/diagnosis_report.pdf"]
}
```

### 5. è½¬æ´¾å·¥å•

```http
POST /api/tickets/{ticket_id}/transfer
Body:
{
  "to_agent_id": "tech_002",
  "to_team": "technical",
  "reason": "éœ€è¦æŠ€æœ¯è¯Šæ–­"
}
```

---

## ğŸ”„ ä¸ä¼šè¯ç³»ç»Ÿçš„å…³è”

### é›†æˆç‚¹1: ä»ä¼šè¯åˆ›å»ºå·¥å•

**åœºæ™¯**: åå¸­åœ¨èŠå¤©ç•Œé¢ç‚¹å‡»"åˆ›å»ºå·¥å•"

```python
# backend.py
@app.post("/api/tickets/from-session")
async def create_ticket_from_session(
    session_name: str,
    ticket_data: TicketCreateRequest,
    agent_info: dict = Depends(get_current_agent)
):
    # 1. è·å–ä¼šè¯ä¿¡æ¯
    session = await session_store.get(session_name)

    # 2. è‡ªåŠ¨å¡«å……å·¥å•ä¿¡æ¯
    ticket = Ticket(
        ticket_id=generate_ticket_id(),
        session_name=session_name,
        user_email=session.user_profile.get("email"),
        title=ticket_data.title,
        description=ticket_data.description,
        category=ticket_data.category,
        priority=auto_determine_priority(session, ticket_data),  # è‡ªåŠ¨åˆ¤æ–­ä¼˜å…ˆçº§
        metadata={
            "conversation_snippet": get_last_n_messages(session, 5),  # æœ€è¿‘5æ¡å¯¹è¯
            "user_profile": session.user_profile
        }
    )

    # 3. è‡ªåŠ¨åˆ†é…
    ticket.assigned_team = CATEGORY_TEAM_MAPPING[ticket.category]

    # 4. è®¡ç®— SLA
    ticket.sla_resolution_deadline = calculate_sla_deadline(ticket)

    # 5. ä¿å­˜
    await db.save(ticket)

    # 6. é€šçŸ¥ç”¨æˆ·
    await notify_user(session, f"æ‚¨çš„é—®é¢˜å·²åˆ›å»ºå·¥å• {ticket.ticket_id}ï¼Œæˆ‘ä»¬ä¼šå°½å¿«å¤„ç†")

    return {"ticket_id": ticket.ticket_id}
```

### é›†æˆç‚¹2: å·¥å•æ›´æ–°é€šçŸ¥ç”¨æˆ·

**åœºæ™¯**: å·¥å•çŠ¶æ€å˜åŒ–æ—¶ï¼Œé€šè¿‡ä¼šè¯é€šçŸ¥ç”¨æˆ·

```python
# ç›‘å¬å·¥å•çŠ¶æ€å˜åŒ–
@app.post("/api/tickets/{ticket_id}/status")
async def update_ticket_status(ticket_id: str, status_update: StatusUpdate):
    ticket = await db.get_ticket(ticket_id)
    old_status = ticket.status
    ticket.status = status_update.status

    # æ›´æ–°æ•°æ®åº“
    await db.save(ticket)

    # é€šçŸ¥ç”¨æˆ·ï¼ˆé€šè¿‡ä¼šè¯ç³»ç»Ÿï¼‰
    if ticket.session_name:
        message = generate_status_notification(old_status, status_update.status)
        await send_manual_message(
            session_name=ticket.session_name,
            role="system",
            content=message
        )
```

### é›†æˆç‚¹3: åå¸­å·¥ä½œå°æ˜¾ç¤ºå·¥å•

**å‰ç«¯é›†æˆ**: åå¸­å·¥ä½œå°å¢åŠ "å·¥å•"æ ‡ç­¾é¡µ

```vue
<!-- agent-workbench/src/views/Dashboard.vue -->
<template>
  <el-tabs v-model="activeTab">
    <el-tab-pane label="ä¼šè¯" name="sessions">
      <SessionList />
    </el-tab-pane>

    <!-- â­ æ–°å¢ï¼šå·¥å•æ ‡ç­¾é¡µ -->
    <el-tab-pane label="å·¥å•" name="tickets">
      <TicketList />
    </el-tab-pane>
  </el-tabs>
</template>
```

---

## â±ï¸ å®æ–½æ—¶é—´ä¼°ç®—

### é˜¶æ®µ1: åŸºç¡€æ¶æ„ï¼ˆWeek 1ï¼‰

| ä»»åŠ¡ | å·¥ä½œé‡ | è¯´æ˜ |
|------|--------|------|
| æ•°æ®åº“è®¾è®¡ | 4å°æ—¶ | è®¾è®¡è¡¨ç»“æ„ã€ç´¢å¼•ã€çº¦æŸ |
| æ•°æ®æ¨¡å‹å®ç° | 4å°æ—¶ | SQLAlchemy æ¨¡å‹å®šä¹‰ |
| æ•°æ®åº“è¿ç§» | 2å°æ—¶ | Alembic è¿ç§»è„šæœ¬ |
| **å°è®¡** | **10å°æ—¶** | - |

### é˜¶æ®µ2: æ ¸å¿ƒåŠŸèƒ½ï¼ˆWeek 2ï¼‰

| ä»»åŠ¡ | å·¥ä½œé‡ | è¯´æ˜ |
|------|--------|------|
| åˆ›å»ºå·¥å• API | 4å°æ—¶ | POST /api/tickets |
| å·¥å•åˆ—è¡¨ API | 3å°æ—¶ | GET /api/tickets |
| å·¥å•è¯¦æƒ… API | 2å°æ—¶ | GET /api/tickets/{id} |
| æ›´æ–°çŠ¶æ€ API | 3å°æ—¶ | PUT /api/tickets/{id}/status |
| æ·»åŠ ç•™è¨€ API | 3å°æ—¶ | POST /api/tickets/{id}/comments |
| è½¬æ´¾å·¥å• API | 3å°æ—¶ | POST /api/tickets/{id}/transfer |
| **å°è®¡** | **18å°æ—¶** | - |

### é˜¶æ®µ3: SLA ç®¡ç†ï¼ˆWeek 3ï¼‰

| ä»»åŠ¡ | å·¥ä½œé‡ | è¯´æ˜ |
|------|--------|------|
| SLA è®¡ç®—é€»è¾‘ | 4å°æ—¶ | è®¡ç®—æˆªæ­¢æ—¶é—´ã€çŠ¶æ€ |
| Celery å®šæ—¶ä»»åŠ¡ | 4å°æ—¶ | æ¯åˆ†é’Ÿæ£€æŸ¥ SLA |
| SLA é¢„è­¦é€šçŸ¥ | 3å°æ—¶ | å³å°†è¿åæ—¶é€šçŸ¥ |
| **å°è®¡** | **11å°æ—¶** | - |

### é˜¶æ®µ4: å‰ç«¯ç•Œé¢ï¼ˆWeek 4-5ï¼‰

| ä»»åŠ¡ | å·¥ä½œé‡ | è¯´æ˜ |
|------|--------|------|
| å·¥å•åˆ—è¡¨é¡µé¢ | 8å°æ—¶ | åˆ—è¡¨ã€ç­›é€‰ã€æ’åº |
| å·¥å•è¯¦æƒ…é¡µé¢ | 8å°æ—¶ | è¯¦æƒ…ã€ç•™è¨€ã€æ—¶é—´çº¿ |
| åˆ›å»ºå·¥å•è¡¨å• | 4å°æ—¶ | è¡¨å•éªŒè¯ã€è‡ªåŠ¨å¡«å…… |
| å·¥å•æ“ä½œæŒ‰é’® | 4å°æ—¶ | æ¥å•ã€è½¬æ´¾ã€å…³é—­ |
| **å°è®¡** | **24å°æ—¶** | - |

### é˜¶æ®µ5: é›†æˆä¸æµ‹è¯•ï¼ˆWeek 6ï¼‰

| ä»»åŠ¡ | å·¥ä½œé‡ | è¯´æ˜ |
|------|--------|------|
| ä¸ä¼šè¯ç³»ç»Ÿé›†æˆ | 6å°æ—¶ | ä»ä¼šè¯åˆ›å»ºå·¥å• |
| é€šçŸ¥ç³»ç»Ÿé›†æˆ | 4å°æ—¶ | Slack/é‚®ä»¶é€šçŸ¥ |
| å•å…ƒæµ‹è¯• | 8å°æ—¶ | API æµ‹è¯• |
| é›†æˆæµ‹è¯• | 8å°æ—¶ | ç«¯åˆ°ç«¯æµ‹è¯• |
| **å°è®¡** | **26å°æ—¶** | - |

### æ€»è®¡: **89 å°æ—¶** â‰ˆ **11 ä¸ªå·¥ä½œæ—¥**

---

## â“ å¸¸è§é—®é¢˜ FAQ

### Q1: å·¥å•ç³»ç»Ÿæ˜¯å¦å¿…é¡»ä½¿ç”¨ PostgreSQLï¼Ÿ

**A**: å¼ºçƒˆå»ºè®®ä½¿ç”¨ PostgreSQLã€‚åŸå› ï¼š
- SQLite ä¸æ”¯æŒå¹¶å‘å†™å…¥ï¼ˆå·¥å•ç³»ç»Ÿå¤šåå¸­åŒæ—¶æ“ä½œï¼‰
- PostgreSQL æ”¯æŒå…¨æ–‡æœç´¢ï¼ˆå·¥å•å†…å®¹æœç´¢ï¼‰
- PostgreSQL æ”¯æŒ JSONB å­—æ®µï¼ˆmetadata é«˜æ•ˆæŸ¥è¯¢ï¼‰
- ç”Ÿäº§ç¯å¢ƒæ ‡å‡†é€‰æ‹©

### Q2: å¦‚æœç”¨æˆ·åœ¨éå·¥ä½œæ—¶é—´å’¨è¯¢ï¼Œå·¥å• SLA å¦‚ä½•è®¡ç®—ï¼Ÿ

**A**: SLA åªè®¡ç®—å·¥ä½œæ—¶é—´ã€‚

```python
def calculate_sla_deadline(ticket, sla_hours):
    """è®¡ç®— SLA æˆªæ­¢æ—¶é—´ï¼ˆè·³è¿‡éå·¥ä½œæ—¶é—´ï¼‰"""
    deadline = ticket.created_at
    remaining_hours = sla_hours

    while remaining_hours > 0:
        deadline += timedelta(hours=1)
        if is_working_hour(deadline):  # å·¥ä½œæ—¥ 9:00-18:00
            remaining_hours -= 1

    return deadline
```

### Q3: å·¥å•æ˜¯å¦æ”¯æŒé™„ä»¶ä¸Šä¼ ï¼Ÿ

**A**: æ”¯æŒã€‚å®ç°æ–¹å¼ï¼š
- å‰ç«¯ä¸Šä¼ åˆ° OSSï¼ˆå¦‚ AWS S3ã€é˜¿é‡Œäº‘ OSSï¼‰
- è¿”å› URL å­˜å‚¨åˆ° `TicketComment.attachments`
- æ–‡ä»¶ç±»å‹é™åˆ¶ï¼šPDFã€å›¾ç‰‡ã€æ—¥å¿—æ–‡ä»¶ï¼ˆ< 10MBï¼‰

### Q4: å¦‚ä½•é˜²æ­¢å·¥å•é‡å¤åˆ›å»ºï¼Ÿ

**A**: å®æ–½å»é‡é€»è¾‘ï¼š

```python
async def create_ticket(session_name, ticket_data):
    # æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ç›¸åŒé—®é¢˜çš„å·¥å•
    existing = await db.query(Ticket).filter(
        Ticket.session_name == session_name,
        Ticket.status.in_(["pending", "in_progress"]),
        Ticket.category == ticket_data.category
    ).first()

    if existing:
        raise HTTPException(
            status_code=409,
            detail=f"å·²å­˜åœ¨ç›¸å…³å·¥å• {existing.ticket_id}ï¼Œè¯·æŸ¥çœ‹è¯¦æƒ…"
        )
```

### Q5: å·¥å•å…³é—­åèƒ½å¦é‡æ–°æ‰“å¼€ï¼Ÿ

**A**: å¯ä»¥ã€‚å®æ–½æ–¹å¼ï¼š

```python
@app.post("/api/tickets/{ticket_id}/reopen")
async def reopen_ticket(ticket_id: str, reason: str):
    ticket = await db.get_ticket(ticket_id)

    if ticket.status != "closed":
        raise HTTPException(400, "åªèƒ½é‡å¼€å·²å…³é—­çš„å·¥å•")

    # çŠ¶æ€å›é€€åˆ°"å¤„ç†ä¸­"
    ticket.status = "in_progress"
    ticket.closed_at = None

    # é‡æ–°è®¡ç®— SLA
    ticket.sla_resolution_deadline = calculate_sla_deadline(ticket)

    await db.save(ticket)
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `prd/01_å…¨å±€æŒ‡å¯¼/PRD_COMPLETE_v3.0.md` - ç¬¬ 3.1-3.3 èŠ‚ï¼ˆå·¥å•åŠŸèƒ½éœ€æ±‚ï¼‰
- `prd/02_çº¦æŸä¸åŸåˆ™/CONSTRAINTS_AND_PRINCIPLES.md` - çº¦æŸéµå®ˆ
- `CLAUDE.md` - å¼€å‘æµç¨‹è§„èŒƒ

---

## âœ… ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç”¨æˆ·ç¡®è®¤äº‹é¡¹

è¯·ç”¨æˆ·ç¡®è®¤ä»¥ä¸‹é—®é¢˜ï¼š

1. **æ•°æ®åº“é€‰æ‹©**: æ˜¯å¦åŒæ„ä½¿ç”¨ PostgreSQLï¼Ÿï¼ˆéœ€å®‰è£…é…ç½®ï¼‰
2. **å¤–éƒ¨é›†æˆ**: æ˜¯å¦éœ€è¦ Shopify API é›†æˆï¼Ÿï¼ˆéœ€æä¾› API Keyï¼‰
3. **é€šçŸ¥æ¸ é“**: æ˜¯å¦éœ€è¦ Slack/ä¼ä¸šå¾®ä¿¡é€šçŸ¥ï¼Ÿï¼ˆéœ€æä¾› Webhook URLï¼‰
4. **å®æ–½ä¼˜å…ˆçº§**: æ˜¯å¦åŒæ„æŒ‰ Week 1-6 çš„é¡ºåºå®æ–½ï¼Ÿ

### å¼€å‘å‰å‡†å¤‡

ç¡®è®¤åéœ€è¦ï¼š
1. å®‰è£… PostgreSQL æ•°æ®åº“
2. å®‰è£… Redis ç¼“å­˜
3. å®‰è£… Celery å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—
4. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆShopifyã€é€šçŸ¥æ¸ é“ï¼‰

---

**æ–‡æ¡£ç»´æŠ¤è€…**: Fiido AI å®¢æœå¼€å‘å›¢é˜Ÿ
**æœ€åæ›´æ–°**: 2025-11-25
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**çŠ¶æ€**: ğŸ“ æ–¹æ¡ˆå¾…å®¡æ ¸
