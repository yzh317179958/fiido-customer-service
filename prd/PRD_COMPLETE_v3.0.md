# AI å®¢æœç³»ç»Ÿ - å®Œæ•´ä¼ä¸šçº§äººå·¥æ¥ç®¡é—­ç¯æ–¹æ¡ˆ PRD v3.0

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

- **æ–‡æ¡£ç‰ˆæœ¬**: v3.0
- **æ›´æ–°æ—¶é—´**: 2025-11-21
- **æ–‡æ¡£çŠ¶æ€**: è¡¥å……å®Œå–„ç‰ˆï¼ˆåŸºäºå®é™…é¡¹ç›®è¿›åº¦ï¼‰
- **å˜æ›´åŸå› **: åŸºäºé¡¹ç›®å®é™…å®ç°æƒ…å†µï¼Œè¡¥å……ç¼ºå¤±çš„å‰ç«¯UIã€åå¸­å·¥ä½œå°ã€çŠ¶æ€æœºå®Œå–„ç­‰å†…å®¹
- **ç›®æ ‡**: å®ç°å®Œæ•´çš„ã€å¯ç”¨çš„ã€ä¼ä¸šå¯è½åœ°çš„äººå·¥æ¥ç®¡é—­ç¯åŠŸèƒ½

---

## ğŸ¯ æ ¸å¿ƒç›®æ ‡

**æœ€ç»ˆç›®æ ‡**ï¼šå®ç°AIå®¢æœçš„äººå·¥æ¥ç®¡å®Œæ•´é—­ç¯ï¼Œå½“åç«¯æŒ‰ç…§ä¸€å®šé€»è¾‘åˆ¤æ–­è§¦å‘äººå·¥ï¼Œå¹¶è½¬æ¥åˆ°äººå·¥æ—¶ï¼Œäººå·¥å¯ä»¥å®æ—¶åœ¨çº¿å›å¤ï¼Œå½¢æˆä¼ä¸šå¯è½åœ°çš„å®Œæ•´åŠŸèƒ½ã€‚

---

## ğŸ“Š å½“å‰é¡¹ç›®çŠ¶æ€è¯„ä¼°ï¼ˆ2025-11-21ï¼‰

### âœ… å·²å®Œæˆéƒ¨åˆ†ï¼ˆP0åç«¯ï¼‰

| æ¨¡å— | å®Œæˆåº¦ | è¯´æ˜ |
|------|--------|------|
| **SessionState** | âœ… 100% | ä¼šè¯çŠ¶æ€ç®¡ç†æ¨¡å‹å®Œæ•´ |
| **Regulator** | âœ… 100% | ç›‘ç®¡å¼•æ“ï¼ˆå…³é”®è¯ã€å¤±è´¥æ£€æµ‹ã€VIPï¼‰|
| **æ ¸å¿ƒAPI** | âœ… 100% | 4ä¸ªäººå·¥æ¥ç®¡APIå·²å®ç° |
| **SSEæ¨é€** | âœ… 100% | å¼‚æ­¥é˜Ÿåˆ—æœºåˆ¶å·²å®ç° |
| **AIå¯¹è¯é›†æˆ** | âœ… 100% | ç›‘ç®¡è§¦å‘å·²é›†æˆåˆ°å¯¹è¯æµ |
| **æµ‹è¯•è¦†ç›–** | âœ… 100% | APIæµ‹è¯•å’ŒSSEæµ‹è¯•å®Œæˆ |

**æ–‡ä»¶æ¸…å•**ï¼š
- `backend.py` - æ ¸å¿ƒåç«¯é€»è¾‘
- `src/session_state.py` - ä¼šè¯çŠ¶æ€æ¨¡å‹
- `src/regulator.py` - ç›‘ç®¡å¼•æ“
- `tests/test_p04_apis.py` - APIæµ‹è¯•
- `tests/test_p05_sse.py` - SSEæµ‹è¯•

### âš ï¸ éƒ¨åˆ†å®Œæˆï¼ˆå­˜åœ¨é—®é¢˜ï¼‰

| æ¨¡å— | é—®é¢˜ | å½±å“ |
|------|------|------|
| **çŠ¶æ€æœºè½¬æ¢** | pending_manualçŠ¶æ€ä¸‹AIæœªè¢«é˜»æ­¢ | ç”¨æˆ·å¯èƒ½åœ¨ç­‰å¾…äººå·¥æ—¶ç»§ç»­ä¸AIå¯¹è¯ |
| **çŠ¶æ€è½¬æ¢API** | ç¼ºå°‘pending_manualâ†’manual_liveçš„è½¬æ¢æ¥å£ | åå¸­æ— æ³•æ­£å¼æ¥å…¥ä¼šè¯ |
| **é”™è¯¯å¤„ç†** | éƒ¨åˆ†å¼‚å¸¸åœºæ™¯æœªå®Œæ•´å¤„ç† | å¯èƒ½å¯¼è‡´çŠ¶æ€ä¸ä¸€è‡´ |

### âŒ æœªå®Œæˆéƒ¨åˆ†ï¼ˆå…³é”®ç¼ºå¤±ï¼‰

| æ¨¡å— | å®Œæˆåº¦ | è¯´æ˜ |
|------|--------|------|
| **ç”¨æˆ·å‰ç«¯UI** | âŒ 0% | æ— çŠ¶æ€å±•ç¤ºã€æ— äººå·¥æ¶ˆæ¯æ¸²æŸ“ã€æ— è½¬äººå·¥æŒ‰é’® |
| **åå¸­å·¥ä½œå°** | âŒ 0% | å®Œå…¨æœªå®ç°ï¼Œæ— æ³•æ¥ç®¡ä¼šè¯ |
| **ä¼šè¯åˆ—è¡¨API** | âŒ 0% | ç¼ºå°‘GET /api/sessionsæ¥å£ |
| **æ¥ç®¡API** | âŒ 0% | ç¼ºå°‘takeoveræ¥å£ï¼ˆé˜²æŠ¢å•ï¼‰ |
| **å·¥ä½œæ—¶é—´åˆ¤æ–­** | âŒ 0% | æœªå®ç°ShiftConfig |
| **é‚®ä»¶é€šçŸ¥** | âŒ 0% | æœªå®ç°é‚®ä»¶æ¨¡å— |

---

## ğŸ—ï¸ å®Œæ•´æ¶æ„è®¾è®¡

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·å‰ç«¯ (Vue 3)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ èŠå¤©ç•Œé¢      â”‚  â”‚ çŠ¶æ€æŒ‡ç¤ºå™¨    â”‚  â”‚ è½¬äººå·¥æŒ‰é’®    â”‚         â”‚
â”‚  â”‚ ChatPanel    â”‚  â”‚ StatusBar    â”‚  â”‚ EscalateBtn  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚         â”‚                  â”‚                  â”‚                  â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                            â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FastAPI åç«¯æœåŠ¡                               â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚              AI å¯¹è¯æ ¸å¿ƒï¼ˆä¸å¯ä¿®æ”¹ï¼‰                  â”‚       â”‚
â”‚  â”‚  â€¢ /api/chat (åŒæ­¥)                                  â”‚       â”‚
â”‚  â”‚  â€¢ /api/chat/stream (SSEæµå¼)                        â”‚       â”‚
â”‚  â”‚  â€¢ Coze API è°ƒç”¨é€»è¾‘                                 â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚          äººå·¥æ¥ç®¡æ‰©å±•ï¼ˆæ–°å¢åŠŸèƒ½ï¼‰                     â”‚       â”‚
â”‚  â”‚                                                      â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚       â”‚
â”‚  â”‚  â”‚ SessionStore   â”‚â—„â”€â”€â”€â”¤  Regulator     â”‚          â”‚       â”‚
â”‚  â”‚  â”‚ ä¼šè¯çŠ¶æ€ç®¡ç†    â”‚    â”‚  ç›‘ç®¡å¼•æ“       â”‚          â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚       â”‚
â”‚  â”‚           â”‚                                          â”‚       â”‚
â”‚  â”‚           â†“                                          â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚       â”‚
â”‚  â”‚  â”‚ SSE Queue      â”‚    â”‚ Manual APIs    â”‚          â”‚       â”‚
â”‚  â”‚  â”‚ æ¶ˆæ¯é˜Ÿåˆ—        â”‚    â”‚ äººå·¥æ¥å£        â”‚          â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   åå¸­å·¥ä½œå° (Vue 3)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ ä¼šè¯é˜Ÿåˆ—      â”‚  â”‚ èŠå¤©é¢æ¿      â”‚  â”‚ æ“ä½œæŒ‰é’®      â”‚         â”‚
â”‚  â”‚ SessionQueue â”‚  â”‚ ChatPanel    â”‚  â”‚ Actions      â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ å®Œæ•´çŠ¶æ€æœºè®¾è®¡

### ä¼šè¯çŠ¶æ€å®šä¹‰

```python
class SessionStatus(str, Enum):
    BOT_ACTIVE = "bot_active"           # AIæœåŠ¡ä¸­
    PENDING_MANUAL = "pending_manual"   # ç­‰å¾…äººå·¥æ¥å…¥
    MANUAL_LIVE = "manual_live"         # äººå·¥æœåŠ¡ä¸­
    AFTER_HOURS_EMAIL = "after_hours_email"  # éå·¥ä½œæ—¶é—´å·²å‘é‚®ä»¶
    CLOSED = "closed"                   # å·²å…³é—­
```

### çŠ¶æ€è½¬æ¢æµç¨‹

```mermaid
graph LR
    A[bot_active] -->|è§¦å‘ç›‘ç®¡/ç”¨æˆ·è¯·æ±‚| B[pending_manual]
    B -->|åå¸­æ¥å…¥| C[manual_live]
    C -->|åå¸­é‡Šæ”¾| A
    B -->|éå·¥ä½œæ—¶é—´| D[after_hours_email]
    D -->|åå¸­è¡¥å›| C
    C -->|è¶…æ—¶/å…³é—­| E[closed]
    E -->|é‡æ–°æ¿€æ´»| A
```

### è§¦å‘æ¡ä»¶è¯¦è§£

| çŠ¶æ€è½¬æ¢ | è§¦å‘æ¡ä»¶ | æ‰§è¡Œè€… | API |
|---------|----------|--------|-----|
| **bot_active â†’ pending_manual** | 1. å…³é”®è¯åŒ¹é…<br>2. AIè¿ç»­å¤±è´¥â‰¥3æ¬¡<br>3. VIPç”¨æˆ·<br>4. ç”¨æˆ·ç‚¹å‡»"è½¬äººå·¥" | ç³»ç»Ÿ/ç”¨æˆ· | `/api/manual/escalate` |
| **pending_manual â†’ manual_live** | åå¸­ç‚¹å‡»"æ¥å…¥" | åå¸­ | `/api/sessions/{id}/takeover` |
| **manual_live â†’ bot_active** | åå¸­ç‚¹å‡»"ç»“æŸæœåŠ¡" | åå¸­ | `/api/sessions/{id}/release` |
| **pending_manual â†’ after_hours_email** | éå·¥ä½œæ—¶é—´è§¦å‘ | ç³»ç»Ÿ | è‡ªåŠ¨ |
| **manual_live â†’ closed** | è¶…æ—¶/ä¸»åŠ¨å…³é—­ | ç³»ç»Ÿ/åå¸­ | `/api/sessions/{id}/close` |

---

## ğŸ”§ å®Œæ•´åŠŸèƒ½éœ€æ±‚ï¼ˆåˆ†é˜¶æ®µå®ç°ï¼‰

### P0-è¡¥å……é˜¶æ®µï¼ˆå½“å‰æ€¥éœ€ï¼‰

**ç›®æ ‡**ï¼šä¿®å¤å·²å‘ç°çš„é—®é¢˜ï¼Œè¡¥å……ç¼ºå¤±çš„åŸºç¡€åŠŸèƒ½

| æ¨¡å— | ä»»åŠ¡ | ä¼˜å…ˆçº§ | å·¥ä½œé‡ |
|------|------|--------|--------|
| **åç«¯çŠ¶æ€æœºä¿®å¤** | ä¿®å¤pending_manualçŠ¶æ€ä¸‹AIæœªè¢«é˜»æ­¢çš„é—®é¢˜ | ğŸ”´ P0 | 2å°æ—¶ |
| **æ–°å¢takeover API** | å®ç°åå¸­æ¥å…¥æ¥å£ï¼ˆé˜²æŠ¢å•é€»è¾‘ï¼‰ | ğŸ”´ P0 | 3å°æ—¶ |
| **æ–°å¢sessionsåˆ—è¡¨API** | å®ç°ä¼šè¯åˆ—è¡¨æŸ¥è¯¢æ¥å£ | ğŸ”´ P0 | 2å°æ—¶ |
| **é”™è¯¯å¤„ç†å®Œå–„** | å®Œå–„å¼‚å¸¸åœºæ™¯å¤„ç† | ğŸŸ¡ P1 | 2å°æ—¶ |

### P1-å‰ç«¯æ”¹é€ é˜¶æ®µ

**ç›®æ ‡**ï¼šå®ç°ç”¨æˆ·ç«¯å®Œæ•´UIå’Œäº¤äº’

| æ¨¡å— | ä»»åŠ¡ | ä¼˜å…ˆçº§ | å·¥ä½œé‡ | æ–‡ä»¶ |
|------|------|--------|--------|------|
| **çŠ¶æ€ç®¡ç†æ‰©å±•** | æ·»åŠ sessionStatusã€escalationInfoç­‰çŠ¶æ€ | ğŸ”´ P0 | 1å°æ—¶ | `chatStore.ts` |
| **Messageç±»å‹æ‰©å±•** | æ”¯æŒagentã€systemè§’è‰² | ğŸ”´ P0 | 1å°æ—¶ | `types/index.ts` |
| **çŠ¶æ€æŒ‡ç¤ºå™¨** | é¡¶éƒ¨çŠ¶æ€æ¡ç»„ä»¶ | ğŸ”´ P0 | 2å°æ—¶ | `StatusBar.vue` (æ–°å»º) |
| **è½¬äººå·¥æŒ‰é’®** | æ·»åŠ ä¸»åŠ¨è½¬äººå·¥å…¥å£ | ğŸ”´ P0 | 1å°æ—¶ | `ChatPanel.vue` |
| **äººå·¥æ¶ˆæ¯æ¸²æŸ“** | æ”¯æŒagentè§’è‰²æ¶ˆæ¯æ˜¾ç¤º | ğŸ”´ P0 | 2å°æ—¶ | `ChatMessage.vue` |
| **SSEäº‹ä»¶æ‰©å±•** | å¤„ç†manual_messageå’Œstatus_changeäº‹ä»¶ | ğŸ”´ P0 | 2å°æ—¶ | `api/chat.ts` |
| **è¾“å…¥æ§åˆ¶** | æ ¹æ®çŠ¶æ€åˆ‡æ¢å‘é€æ¥å£ | ğŸ”´ P0 | 2å°æ—¶ | `ChatPanel.vue` |
| **å†å²å›å¡«** | æ‰“å¼€é¢æ¿æ—¶åŠ è½½å†å²æ¶ˆæ¯ | ğŸŸ¡ P1 | 2å°æ—¶ | `ChatPanel.vue` |

**æ€»è®¡å·¥ä½œé‡**ï¼šçº¦12-14å°æ—¶

### P2-åå¸­å·¥ä½œå°é˜¶æ®µ

**ç›®æ ‡**ï¼šå®ç°åå¸­ç«¯å®Œæ•´åŠŸèƒ½

| æ¨¡å— | ä»»åŠ¡ | ä¼˜å…ˆçº§ | å·¥ä½œé‡ |
|------|------|--------|--------|
| **é¡¹ç›®åˆå§‹åŒ–** | åˆ›å»ºagent-workbenchå­é¡¹ç›® | ğŸ”´ P0 | 2å°æ—¶ |
| **ç™»å½•é‰´æƒ** | å®ç°åå¸­ç™»å½•ï¼ˆJWT role=agentï¼‰ | ğŸ”´ P0 | 3å°æ—¶ |
| **ä¼šè¯é˜Ÿåˆ—** | å±•ç¤ºå¾…æ¥å…¥/è¿›è¡Œä¸­ä¼šè¯åˆ—è¡¨ | ğŸ”´ P0 | 4å°æ—¶ |
| **èŠå¤©é¢æ¿** | å®æ—¶èŠå¤©ç•Œé¢ï¼ˆå¤ç”¨ç”¨æˆ·ç«¯ç»„ä»¶ï¼‰ | ğŸ”´ P0 | 3å°æ—¶ |
| **æ¥å…¥æ“ä½œ** | æ¥å…¥/é‡Šæ”¾ä¼šè¯åŠŸèƒ½ | ğŸ”´ P0 | 2å°æ—¶ |
| **å®æ—¶æ›´æ–°** | SSE/è½®è¯¢æœºåˆ¶ | ğŸŸ¡ P1 | 3å°æ—¶ |
| **å¿«æ·çŸ­è¯­** | å¸¸ç”¨å›å¤æ¨¡æ¿ | ğŸŸ¢ P2 | 2å°æ—¶ |

**æ€»è®¡å·¥ä½œé‡**ï¼šçº¦19-21å°æ—¶

### P3-å¢å¼ºåŠŸèƒ½é˜¶æ®µï¼ˆå¯é€‰ï¼‰

| åŠŸèƒ½ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|------|------|--------|
| å·¥ä½œæ—¶é—´åˆ¤æ–­ | ShiftConfigé…ç½® | ğŸŸ¢ P2 |
| é‚®ä»¶é€šçŸ¥ | éå·¥ä½œæ—¶é—´è‡ªåŠ¨å‘é‚®ä»¶ | ğŸŸ¢ P2 |
| æ¶ˆæ¯æ¨¡æ¿ | å¿«æ·å›å¤ã€è¯æœ¯åº“ | ğŸŸ¢ P2 |
| ä¼šè¯è½¬æ¥ | åå¸­é—´è½¬æ¥ | ğŸŸ¢ P2 |
| è´¨æ£€åŠŸèƒ½ | ä¼šè¯å½•éŸ³ã€è¯„åˆ† | ğŸŸ¢ P2 |
| æ•°æ®ç»Ÿè®¡ | æ¥å…¥é‡ã€å“åº”æ—¶é•¿ç­‰ | ğŸŸ¢ P2 |

---

## ğŸ¨ ç”¨æˆ·å‰ç«¯UIè®¾è®¡è§„èŒƒ

### 1. çŠ¶æ€æŒ‡ç¤ºå™¨è®¾è®¡

**ä½ç½®**ï¼šèŠå¤©é¢æ¿é¡¶éƒ¨ï¼ˆå¤´åƒå³ä¾§ï¼‰

**çŠ¶æ€æ ·å¼**ï¼š

| çŠ¶æ€ | æ˜¾ç¤ºæ–‡æœ¬ | é¢œè‰² | å›¾æ ‡ |
|------|----------|------|------|
| bot_active | "AIæœåŠ¡ä¸­" | ç»¿è‰² #10B981 | ğŸ¤– |
| pending_manual | "ç­‰å¾…äººå·¥æ¥å…¥..." | é»„è‰² #F59E0B | â³ |
| manual_live | "äººå·¥å®¢æœ - {åå¸­åç§°}" | è“è‰² #3B82F6 | ğŸ‘¤ |
| after_hours_email | "éå·¥ä½œæ—¶é—´" | ç°è‰² #6B7280 | ğŸ“§ |

**å®ç°ç¤ºä¾‹**ï¼š

```vue
<template>
  <div class="status-bar" :class="statusClass">
    <span class="status-icon">{{ statusIcon }}</span>
    <span class="status-text">{{ statusText }}</span>
  </div>
</template>

<script setup lang="ts">
import { computed } from 'vue'
import { useChatStore } from '@/stores/chatStore'

const chatStore = useChatStore()

const statusIcon = computed(() => {
  switch (chatStore.sessionStatus) {
    case 'bot_active': return 'ğŸ¤–'
    case 'pending_manual': return 'â³'
    case 'manual_live': return 'ğŸ‘¤'
    case 'after_hours_email': return 'ğŸ“§'
    default: return ''
  }
})

const statusText = computed(() => {
  switch (chatStore.sessionStatus) {
    case 'bot_active': return 'AIæœåŠ¡ä¸­'
    case 'pending_manual': return 'ç­‰å¾…äººå·¥æ¥å…¥...'
    case 'manual_live':
      return `äººå·¥å®¢æœ - ${chatStore.agentName || 'å®¢æœ'}`
    case 'after_hours_email': return 'éå·¥ä½œæ—¶é—´'
    default: return ''
  }
})

const statusClass = computed(() => {
  return `status-${chatStore.sessionStatus}`
})
</script>

<style scoped>
.status-bar {
  padding: 8px 16px;
  border-radius: 20px;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 13px;
  font-weight: 500;
}

.status-bot_active {
  background: #D1FAE5;
  color: #065F46;
}

.status-pending_manual {
  background: #FEF3C7;
  color: #92400E;
}

.status-manual_live {
  background: #DBEAFE;
  color: #1E40AF;
}

.status-after_hours_email {
  background: #F3F4F6;
  color: #374151;
}
</style>
```

### 2. è½¬äººå·¥æŒ‰é’®è®¾è®¡

**ä½ç½®**ï¼šèŠå¤©è¾“å…¥æ¡†å³ä¾§æˆ–æ°”æ³¡èœå•ä¸­

**è®¾è®¡æ–¹æ¡ˆA**ï¼šç‹¬ç«‹æŒ‰é’®ï¼ˆæ¨èï¼‰

```vue
<button
  class="escalate-button"
  @click="handleEscalate"
  :disabled="isEscalating || sessionStatus !== 'bot_active'"
>
  <svg class="icon"><!-- äººå·¥å›¾æ ‡ --></svg>
  <span>è½¬äººå·¥</span>
</button>
```

**è®¾è®¡æ–¹æ¡ˆB**ï¼šé›†æˆåˆ°æ°”æ³¡èœå•

```vue
<div class="sub-bubbles">
  <button class="sub-bubble" @click="handleEscalate">
    <span class="bubble-text">è½¬äººå·¥å®¢æœ</span>
  </button>
  <button class="sub-bubble" @click="handleClearConversation">
    <span class="bubble-text">æ¸…é™¤å¯¹è¯</span>
  </button>
  <button class="sub-bubble" @click="handleNewSession">
    <span class="bubble-text">æ–°å»ºå¯¹è¯</span>
  </button>
</div>
```

### 3. äººå·¥æ¶ˆæ¯æ ·å¼

**åŒºåˆ«äºAIæ¶ˆæ¯çš„è®¾è®¡**ï¼š

- **å¤´åƒ**ï¼šä½¿ç”¨åå¸­å¤´åƒï¼ˆé»˜è®¤å›¾æ ‡ğŸ‘¤ï¼‰
- **æ˜µç§°**ï¼šæ˜¾ç¤ºåå¸­åç§°
- **èƒŒæ™¯è‰²**ï¼šä½¿ç”¨ä¸åŒçš„èƒŒæ™¯è‰²ï¼ˆå¦‚æµ…è“è‰²ï¼‰
- **æ ‡ç­¾**ï¼šæ·»åŠ "äººå·¥"æ ‡ç­¾

```vue
<template>
  <div class="message" :class="messageClass">
    <div class="message-avatar" v-if="message.role !== 'user'">
      <!-- Agentå¤´åƒ -->
      <div v-if="message.role === 'agent'" class="agent-avatar">
        <span class="agent-icon">ğŸ‘¤</span>
      </div>
      <!-- AIå¤´åƒ -->
      <img v-else-if="botConfig.icon_url" :src="botConfig.icon_url" />
    </div>

    <div class="message-body">
      <div class="message-header" v-if="message.role === 'agent'">
        <span class="agent-name">{{ message.agent_name || 'å®¢æœ' }}</span>
        <span class="agent-badge">äººå·¥</span>
      </div>
      <div class="message-content">{{ message.content }}</div>
    </div>
  </div>
</template>

<style scoped>
.message.agent .message-body {
  background: #EFF6FF; /* æµ…è“è‰²èƒŒæ™¯ */
  border-left: 3px solid #3B82F6;
}

.agent-badge {
  background: #3B82F6;
  color: white;
  padding: 2px 8px;
  border-radius: 10px;
  font-size: 11px;
  font-weight: 500;
}

.agent-avatar {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  display: flex;
  align-items: center;
  justify-content: center;
}
</style>
```

---

## ğŸ–¥ï¸ åå¸­å·¥ä½œå°UIè®¾è®¡è§„èŒƒ

### 1. æ•´ä½“å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Header (é¡¶éƒ¨å¯¼èˆªæ )                                â”‚
â”‚  åå¸­å·¥ä½œå° | å¼ ä¸‰ (åœ¨çº¿) | ä»Šæ—¥æ¥å¾…: 12 | é€€å‡º     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              â”‚                                     â”‚
â”‚  ä¼šè¯é˜Ÿåˆ—     â”‚        èŠå¤©é¢æ¿                      â”‚
â”‚  (å·¦ä¾§ 30%)  â”‚        (å³ä¾§ 70%)                    â”‚
â”‚              â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ å¾…æ¥å…¥  â”‚  â”‚  â”‚ ä¼šè¯ä¿¡æ¯                     â”‚   â”‚
â”‚  â”‚ (3)    â”‚  â”‚  â”‚ è®¿å®¢A | VIP | ç­‰å¾…ä¸­          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚              â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ è¿›è¡Œä¸­  â”‚  â”‚  â”‚ æ¶ˆæ¯å†å²                     â”‚   â”‚
â”‚  â”‚ (2)    â”‚  â”‚  â”‚                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚                             â”‚   â”‚
â”‚              â”‚  â”‚                             â”‚   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”‚ å·²å®Œæˆ  â”‚  â”‚                                     â”‚
â”‚  â”‚ (15)   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ è¾“å…¥æ¡† + å¿«æ·çŸ­è¯­              â”‚   â”‚
â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚              â”‚                                     â”‚
â”‚              â”‚  [æ¥å…¥ä¼šè¯] [ç»“æŸæœåŠ¡] [è½¬æ¥]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. ä¼šè¯é˜Ÿåˆ—è®¾è®¡

**å¡ç‰‡å¼åˆ—è¡¨**ï¼š

```vue
<template>
  <div class="session-list">
    <div class="session-tabs">
      <button
        class="tab"
        :class="{ active: activeTab === 'pending' }"
        @click="activeTab = 'pending'"
      >
        å¾…æ¥å…¥ ({{ pendingCount }})
      </button>
      <button
        class="tab"
        :class="{ active: activeTab === 'live' }"
        @click="activeTab = 'live'"
      >
        è¿›è¡Œä¸­ ({{ liveCount }})
      </button>
    </div>

    <div class="session-cards">
      <div
        v-for="session in filteredSessions"
        :key="session.session_name"
        class="session-card"
        :class="{ selected: selectedSession === session.session_name }"
        @click="selectSession(session)"
      >
        <div class="card-header">
          <span class="user-name">{{ session.user_profile.nickname }}</span>
          <span v-if="session.user_profile.vip" class="vip-badge">VIP</span>
        </div>

        <div class="card-body">
          <div class="last-message">
            {{ session.last_message_preview?.content }}
          </div>
          <div class="escalation-reason" v-if="session.escalation">
            åŸå› : {{ getReasonText(session.escalation.reason) }}
          </div>
        </div>

        <div class="card-footer">
          <span class="waiting-time">
            ç­‰å¾… {{ formatWaitingTime(session.escalation?.trigger_at) }}
          </span>
          <span class="severity-badge" :class="session.escalation?.severity">
            {{ session.escalation?.severity }}
          </span>
        </div>
      </div>
    </div>
  </div>
</template>
```

### 3. å¿«æ·çŸ­è¯­è®¾è®¡

**ä¸‹æ‹‰èœå•æˆ–ä¾§è¾¹æ **ï¼š

```vue
<template>
  <div class="quick-replies">
    <button class="quick-reply-trigger" @click="showQuickReplies = !showQuickReplies">
      å¿«æ·çŸ­è¯­ â–¼
    </button>

    <div v-if="showQuickReplies" class="quick-reply-list">
      <div
        v-for="(reply, index) in quickReplies"
        :key="index"
        class="quick-reply-item"
        @click="insertQuickReply(reply.content)"
      >
        <div class="reply-title">{{ reply.title }}</div>
        <div class="reply-preview">{{ reply.content.substring(0, 30) }}...</div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
const quickReplies = [
  { title: 'æ¬¢è¿è¯­', content: 'æ‚¨å¥½ï¼Œæˆ‘æ˜¯å®¢æœå°ç‹ï¼Œå¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡ï¼' },
  { title: 'æŸ¥è¯¢è®¢å•', content: 'è¯·æä¾›æ‚¨çš„è®¢å•å·ï¼Œæˆ‘å¸®æ‚¨æŸ¥è¯¢ã€‚' },
  { title: 'é€€æ¢è´§', content: 'æˆ‘ä»¬æ”¯æŒ7å¤©æ— ç†ç”±é€€æ¢è´§ï¼Œè¯·é—®æ‚¨é‡åˆ°ä»€ä¹ˆé—®é¢˜ï¼Ÿ' },
  { title: 'ç»“æŸè¯­', content: 'æ„Ÿè°¢æ‚¨çš„å’¨è¯¢ï¼Œç¥æ‚¨ç”Ÿæ´»æ„‰å¿«ï¼' }
]
</script>
```

---

## ğŸ”Œ å®Œæ•´APIè§„èŒƒ

### åç«¯æ–°å¢APIï¼ˆè¡¥å……ï¼‰

#### 1. è·å–ä¼šè¯åˆ—è¡¨

```http
GET /api/sessions
Query Parameters:
  - status: string (å¯é€‰) - pending_manual, manual_live, after_hours_email
  - limit: int (é»˜è®¤50)
  - offset: int (é»˜è®¤0)

Response 200:
{
  "success": true,
  "data": {
    "sessions": [
      {
        "session_name": "session_123",
        "status": "pending_manual",
        "user_profile": { "nickname": "è®¿å®¢A", "vip": true },
        "last_message_preview": { "role": "user", "content": "æˆ‘è¦äººå·¥", "timestamp": 1763605000 },
        "escalation": { "reason": "keyword", "trigger_at": 1763605000, "waiting_seconds": 120 },
        "assigned_agent": null,
        "updated_at": 1763605000
      }
    ],
    "total": 5,
    "has_more": false
  }
}
```

#### 2. åå¸­æ¥å…¥ä¼šè¯ï¼ˆé˜²æŠ¢å•ï¼‰

```http
POST /api/sessions/{session_name}/takeover
Headers:
  Authorization: Bearer {JWT_TOKEN}  # role=agent
Body:
{
  "agent_id": "agent_001",
  "agent_name": "å°ç‹"
}

Response 200:
{
  "success": true,
  "data": {
    "session_name": "session_123",
    "status": "manual_live",
    "assigned_agent": {
      "id": "agent_001",
      "name": "å°ç‹"
    }
  }
}

Response 409:
{
  "success": false,
  "error": "ALREADY_TAKEN",
  "message": "ä¼šè¯å·²è¢«åå¸­ã€å°å¼ ã€‘æ¥å…¥"
}
```

#### 3. ä¼šè¯ç»Ÿè®¡æ¥å£

```http
GET /api/sessions/stats
Response 200:
{
  "success": true,
  "data": {
    "total_sessions": 50,
    "by_status": {
      "bot_active": 35,
      "pending_manual": 3,
      "manual_live": 2,
      "after_hours_email": 5,
      "closed": 5
    },
    "active_agents": 2,
    "avg_waiting_time": 120  // ç§’
  }
}
```

---

## ğŸ§ª å®Œæ•´æµ‹è¯•æ–¹æ¡ˆ

### 1. å•å…ƒæµ‹è¯•

**åç«¯æµ‹è¯•**ï¼š
- SessionStateçŠ¶æ€è½¬æ¢æµ‹è¯•
- Regulatorç›‘ç®¡é€»è¾‘æµ‹è¯•
- APIæ¥å£æµ‹è¯•ï¼ˆå·²å®Œæˆï¼‰

**å‰ç«¯æµ‹è¯•**ï¼š
- StoreçŠ¶æ€ç®¡ç†æµ‹è¯•
- ç»„ä»¶æ¸²æŸ“æµ‹è¯•
- SSEäº‹ä»¶å¤„ç†æµ‹è¯•

### 2. é›†æˆæµ‹è¯•

**åœºæ™¯1ï¼šç”¨æˆ·ä¸»åŠ¨è½¬äººå·¥**
1. ç”¨æˆ·æ‰“å¼€èŠå¤©
2. ç‚¹å‡»"è½¬äººå·¥"æŒ‰é’®
3. éªŒè¯çŠ¶æ€å˜ä¸ºpending_manual
4. åå¸­çœ‹åˆ°å¾…æ¥å…¥æç¤º
5. åå¸­ç‚¹å‡»æ¥å…¥
6. éªŒè¯çŠ¶æ€å˜ä¸ºmanual_live
7. ç”¨æˆ·æ”¶åˆ°"å®¢æœå·²æ¥å…¥"æç¤º
8. åŒæ–¹æ­£å¸¸å¯¹è¯
9. åå¸­ç‚¹å‡»"ç»“æŸæœåŠ¡"
10. éªŒè¯çŠ¶æ€æ¢å¤bot_active

**åœºæ™¯2ï¼šå…³é”®è¯è§¦å‘**
1. ç”¨æˆ·è¾“å…¥"æˆ‘è¦äººå·¥"
2. ç³»ç»Ÿè‡ªåŠ¨è§¦å‘å‡çº§
3. éªŒè¯çŠ¶æ€å˜ä¸ºpending_manual
4. åç»­æµç¨‹åŒåœºæ™¯1

**åœºæ™¯3ï¼šAIå¤±è´¥è§¦å‘**
1. ç”¨æˆ·è¿ç»­3æ¬¡æ”¶åˆ°AIå¤±è´¥å›å¤
2. ç³»ç»Ÿè‡ªåŠ¨è§¦å‘å‡çº§
3. éªŒè¯çŠ¶æ€å˜ä¸ºpending_manual
4. åç»­æµç¨‹åŒåœºæ™¯1

**åœºæ™¯4ï¼šVIPç”¨æˆ·**
1. VIPç”¨æˆ·å‘é€æ¶ˆæ¯
2. ç³»ç»Ÿè‡ªåŠ¨è§¦å‘å‡çº§
3. ä¼˜å…ˆçº§ä¸ºHIGH
4. åç»­æµç¨‹åŒåœºæ™¯1

### 3. ç«¯åˆ°ç«¯æµ‹è¯•

ä½¿ç”¨Playwrightæˆ–Cypressç¼–å†™E2Eæµ‹è¯•ï¼š

```typescript
test('å®Œæ•´äººå·¥æ¥ç®¡æµç¨‹', async ({ page }) => {
  // ç”¨æˆ·ç«¯
  await page.goto('http://localhost:5173')
  await page.click('[data-testid="chat-button"]')
  await page.fill('[data-testid="chat-input"]', 'æˆ‘è¦äººå·¥')
  await page.click('[data-testid="send-button"]')

  // éªŒè¯çŠ¶æ€å˜åŒ–
  await expect(page.locator('[data-testid="status-bar"]'))
    .toHaveText('ç­‰å¾…äººå·¥æ¥å…¥...')

  // åå¸­ç«¯
  await page.goto('http://localhost:5174/agent')
  await page.fill('[data-testid="agent-login"]', 'agent_001')
  await page.click('[data-testid="login-button"]')

  // æ¥å…¥ä¼šè¯
  await page.click('[data-testid="session-card-0"]')
  await page.click('[data-testid="takeover-button"]')

  // å‘é€æ¶ˆæ¯
  await page.fill('[data-testid="agent-input"]', 'æ‚¨å¥½ï¼Œæˆ‘æ˜¯å®¢æœ')
  await page.click('[data-testid="agent-send"]')

  // ç”¨æˆ·ç«¯éªŒè¯æ”¶åˆ°æ¶ˆæ¯
  await page.goto('http://localhost:5173')
  await expect(page.locator('[data-testid="message-agent"]'))
    .toContainText('æ‚¨å¥½ï¼Œæˆ‘æ˜¯å®¢æœ')
})
```

---

## ğŸ“… å®æ–½è®¡åˆ’ï¼ˆå»ºè®®æ—¶é—´çº¿ï¼‰

### ç¬¬1å‘¨ï¼šåç«¯è¡¥å……ï¼ˆ5å¤©ï¼‰

**Day 1-2**ï¼šçŠ¶æ€æœºä¿®å¤å’ŒAPIè¡¥å……
- ä¿®å¤pending_manualçŠ¶æ€ä¸‹AIé˜»æ­¢é€»è¾‘
- å®ç°takeoveræ¥å£ï¼ˆé˜²æŠ¢å•ï¼‰
- å®ç°sessionsåˆ—è¡¨æ¥å£
- å®Œå–„é”™è¯¯å¤„ç†

**Day 3-4**ï¼šæµ‹è¯•å’Œæ–‡æ¡£
- ç¼–å†™è¡¥å……APIçš„æµ‹è¯•
- æ›´æ–°APIæ–‡æ¡£
- è¿›è¡Œé›†æˆæµ‹è¯•

**Day 5**ï¼šReviewå’Œä¼˜åŒ–
- ä»£ç å®¡æŸ¥
- æ€§èƒ½æµ‹è¯•
- Bugä¿®å¤

### ç¬¬2å‘¨ï¼šç”¨æˆ·å‰ç«¯æ”¹é€ ï¼ˆ5å¤©ï¼‰

**Day 1-2**ï¼šçŠ¶æ€ç®¡ç†å’ŒåŸºç¡€ç»„ä»¶
- æ‰©å±•chatStoreï¼ˆsessionStatusã€escalationInfoï¼‰
- åˆ›å»ºStatusBarç»„ä»¶
- æ‰©å±•Messageç±»å‹

**Day 3-4**ï¼šäº¤äº’åŠŸèƒ½
- å®ç°è½¬äººå·¥æŒ‰é’®
- å®ç°äººå·¥æ¶ˆæ¯æ¸²æŸ“
- å®ç°SSEäº‹ä»¶æ‰©å±•
- å®ç°è¾“å…¥æ§åˆ¶é€»è¾‘

**Day 5**ï¼šæµ‹è¯•å’Œä¼˜åŒ–
- ç»„ä»¶æµ‹è¯•
- é›†æˆæµ‹è¯•
- UIä¼˜åŒ–

### ç¬¬3å‘¨ï¼šåå¸­å·¥ä½œå°ï¼ˆ7å¤©ï¼‰

**Day 1-2**ï¼šé¡¹ç›®æ­å»º
- åˆ›å»ºagent-workbenchå­é¡¹ç›®
- å®ç°ç™»å½•é‰´æƒ
- å®ç°åŸºç¡€å¸ƒå±€

**Day 3-4**ï¼šæ ¸å¿ƒåŠŸèƒ½
- å®ç°ä¼šè¯é˜Ÿåˆ—
- å®ç°èŠå¤©é¢æ¿
- å®ç°æ¥å…¥/é‡Šæ”¾æ“ä½œ

**Day 5-6**ï¼šå¢å¼ºåŠŸèƒ½
- å®ç°å¿«æ·çŸ­è¯­
- å®ç°å®æ—¶æ›´æ–°
- ä¼˜åŒ–UI/UX

**Day 7**ï¼šæµ‹è¯•å’Œå‘å¸ƒ
- ç«¯åˆ°ç«¯æµ‹è¯•
- ç”¨æˆ·éªŒæ”¶
- éƒ¨ç½²ä¸Šçº¿

### ç¬¬4å‘¨ï¼šå¢å¼ºåŠŸèƒ½ï¼ˆå¯é€‰ï¼‰

- å·¥ä½œæ—¶é—´åˆ¤æ–­
- é‚®ä»¶é€šçŸ¥
- æ•°æ®ç»Ÿè®¡
- è´¨æ£€åŠŸèƒ½

---

## âœ… éªŒæ”¶æ ‡å‡†

### æ ¸å¿ƒåŠŸèƒ½éªŒæ”¶

| åŠŸèƒ½ | éªŒæ”¶æ ‡å‡† |
|------|----------|
| **AIå¯¹è¯** | åœ¨bot_activeçŠ¶æ€ä¸‹ï¼ŒAIå¯¹è¯æµç¨‹å®Œæ•´æ— è¯¯ |
| **çŠ¶æ€å±•ç¤º** | ç”¨æˆ·ç«¯èƒ½æ¸…æ™°çœ‹åˆ°å½“å‰çŠ¶æ€ï¼ˆAI/ç­‰å¾…/äººå·¥ï¼‰ |
| **è½¬äººå·¥** | ç”¨æˆ·ç‚¹å‡»æŒ‰é’®åèƒ½æˆåŠŸè§¦å‘å‡çº§ |
| **è‡ªåŠ¨è§¦å‘** | å…³é”®è¯ã€å¤±è´¥ã€VIPèƒ½æ­£ç¡®è§¦å‘å‡çº§ |
| **åå¸­æ¥å…¥** | åå¸­èƒ½çœ‹åˆ°å¾…æ¥å…¥åˆ—è¡¨å¹¶æˆåŠŸæ¥å…¥ |
| **å®æ—¶å¯¹è¯** | ç”¨æˆ·å’Œåå¸­èƒ½å®æ—¶æ”¶å‘æ¶ˆæ¯ |
| **é‡Šæ”¾ä¼šè¯** | åå¸­ç»“æŸåçŠ¶æ€æ­£ç¡®æ¢å¤ä¸ºAIæ¨¡å¼ |
| **ä¼šè¯éš”ç¦»** | å¤šä¼šè¯äº’ä¸å¹²æ‰°ï¼Œåå¸­åªèƒ½çœ‹åˆ°è‡ªå·±çš„ä¼šè¯ |

### æ€§èƒ½æ ‡å‡†

| æŒ‡æ ‡ | ç›®æ ‡ |
|------|------|
| APIå“åº”æ—¶é—´ | < 200ms |
| SSEæ¨é€å»¶è¿Ÿ | < 100ms |
| é¡µé¢åŠ è½½æ—¶é—´ | < 2s |
| å¹¶å‘ç”¨æˆ· | æ”¯æŒ100+å¹¶å‘ |
| åå¸­æ•°é‡ | æ”¯æŒ10+åå¸­åŒæ—¶åœ¨çº¿ |

### ç¨³å®šæ€§æ ‡å‡†

| æŒ‡æ ‡ | ç›®æ ‡ |
|------|------|
| å¯ç”¨æ€§ | 99.9% |
| é”™è¯¯ç‡ | < 0.1% |
| å¹³å‡æ•…éšœæ¢å¤æ—¶é—´ | < 5åˆ†é’Ÿ |
| çŠ¶æ€ä¸€è‡´æ€§ | 100% |

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

1. **PRDæ–‡æ¡£**
   - `prd/prd.md` - åŸå§‹PRD v2.2
   - `prd/PRD_COMPLETE_v3.0.md` - æœ¬æ–‡æ¡£ï¼ˆè¡¥å……å®Œå–„ç‰ˆï¼‰

2. **ä»»åŠ¡æ‹†è§£**
   - `prd/backend_tasks.md` - åç«¯ä»»åŠ¡
   - `prd/frontend_client_tasks.md` - å‰ç«¯ç”¨æˆ·ç«¯ä»»åŠ¡
   - `prd/agent_workbench_tasks.md` - åå¸­å·¥ä½œå°ä»»åŠ¡

3. **æŠ€æœ¯æ–‡æ¡£**
   - `prd/TECHNICAL_CONSTRAINTS.md` - æŠ€æœ¯çº¦æŸ
   - `prd/api_contract.md` - APIè§„èŒƒ
   - `docs/P0-APIä½¿ç”¨ç¤ºä¾‹.md` - APIä½¿ç”¨ç¤ºä¾‹

4. **å®ç°æ–‡æ¡£**
   - `docs/P0-å®Œæˆæ€»ç»“.md` - P0å®Œæˆæ€»ç»“
   - `README.md` - é¡¹ç›®è¯´æ˜

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³å¼€å§‹ï¼ˆæœ¬å‘¨ï¼‰

1. **ä¿®å¤åç«¯çŠ¶æ€æœº** (Day 1)
   - ä¿®å¤pending_manualçŠ¶æ€ä¸‹AIæœªè¢«é˜»æ­¢çš„é—®é¢˜
   - æµ‹è¯•éªŒè¯

2. **å®ç°è¡¥å……API** (Day 2-3)
   - å®ç°takeoveræ¥å£
   - å®ç°sessionsåˆ—è¡¨æ¥å£
   - ç¼–å†™æµ‹è¯•

3. **å¯åŠ¨å‰ç«¯æ”¹é€ ** (Day 4-5)
   - æ‰©å±•çŠ¶æ€ç®¡ç†
   - åˆ›å»ºStatusBarç»„ä»¶
   - æ·»åŠ è½¬äººå·¥æŒ‰é’®

### åç»­è®¡åˆ’

- **Week 2**: å®Œæˆç”¨æˆ·å‰ç«¯æ”¹é€ 
- **Week 3**: å®Œæˆåå¸­å·¥ä½œå°
- **Week 4**: å¢å¼ºåŠŸèƒ½ï¼ˆå¯é€‰ï¼‰

---

**æ–‡æ¡£ç»´æŠ¤è€…**: Claude Code
**æœ€åæ›´æ–°**: 2025-11-21
**æ–‡æ¡£ç‰ˆæœ¬**: v3.0
**çŠ¶æ€**: âœ… å·²å®Œæˆ
